<!DOCTYPE html>
<html lang="th">

<head>
    <link rel="icon" type="image/x-icon" href="assets/images/favicon.png">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="K.C. METAL SHEET PUBLIC CO.,LTD">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;700&display=swap" rel="stylesheet">
    <title>Stock Price - KCM</title>

    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.1/css/all.min.css">
    <link rel="stylesheet" href="assets/css/templatemo-chain-app-dev.css">

    <style>
        .page-banner {
            background: linear-gradient(135deg, #1a235a 0%, #2b3990 100%);
            padding: 180px 0 100px 0;
            color: #fff;
            text-align: center;
        }

        .price-card {
            background: #fff;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
            padding: 40px;
            margin-top: -60px;
            position: relative;
            z-index: 10;
        }

        .stock-value {
            font-size: 80px;
            font-weight: 700;
            color: #2b3990;
            line-height: 1;
            margin-bottom: 5px;
        }

        .status-up { color: #28a745; font-weight: 600; font-size: 20px; }
        .status-down { color: #dc3545; font-weight: 600; font-size: 20px; }
        .info-label { color: #888; font-size: 16px; }
        .info-value { font-weight: 600; color: #333; font-size: 18px; }

        .set-link-btn {
            display: inline-block;
            background: #ff581f;
            color: #fff !important;
            padding: 12px 30px;
            border-radius: 30px;
            font-weight: 600;
            transition: 0.3s;
            margin-top: 30px;
            text-decoration: none;
        }

        .set-link-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(255, 88, 31, 0.3);
        }
        
        .divider-custom {
            width: 60px;
            height: 4px;
            background: #ff581f;
            margin: 15px auto;
            border-radius: 2px;
        }

        /* ปุ่มเปลี่ยนภาษา */
        .lang-switch .lang-btn {
            border: 1px solid #ddd;
            background: #fff;
            padding: 2px 8px;
            cursor: pointer;
            font-size: 14px;
            margin-left: 2px;
        }
        .lang-switch .lang-btn.active {
            background: #2b3990;
            color: #fff;
            border-color: #2b3990;
        }
    </style>
</head>

<body>

    <header class="header-area header-sticky wow slideInDown" data-wow-duration="0.75s" data-wow-delay="0s">
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <nav class="main-nav">
                        <a href="index.html" class="logo">
                            <img src="assets/images/logo2.png" style="width: 50%;" alt="Rodtank">
                        </a>
                        <ul class="nav">
                            <li class="scroll-to-section">
                                <a href="index.html">หน้าแรก</a>
                            </li>
                            <li class="scroll-to-section has-dropdown">
                                <a href="#" class="active">นักลงทุนสัมพันธ์ <i class="fa fa-angle-down"></i></a>
                                <ul class="dropdown">
                                    <li><a href="stock-info.html">ข้อมูลหลักทรัพย์</a></li>
                                    <li><a href="stock-price.html">ราคาหุ้น</a></li>
                                    <li><a href="financial-info.html">ข้อมูลสำคัญทางการเงิน</a></li>
                                    <li><a href="news.html">ข่าวสาร</a></li>
                                    <li><a href="publications.html">เอกสารเผยแพร่</a></li>
                                </ul>
                            </li>
                            <li class="scroll-to-section">
                                <a href="#contract">ติดต่อเรา</a>
                            </li>
                            <li class="scroll-to-section">
                                <a href="https://rodtank.com">
                                    <i class="fa fa-shopping-bag"></i>
                                    <span>สินค้าของเรา</span>
                                </a>
                            </li>
                            <li>
                                <div class="lang-switch">
                                    <button class="lang-btn" id="btn-th" onclick="setLang('th')">TH</button>
                                    <button class="lang-btn" id="btn-en" onclick="setLang('en')">EN</button>
                                </div>
                            </li>
                        </ul>
                        <a class='menu-trigger'><span>Menu</span></a>
                    </nav>
                </div>
            </div>
        </div>
    </header>

    <div class="page-banner">
        <div class="container">
            <h2 class="lang-text" data-th="ราคาหุ้น" data-en="Stock Price">ราคาหุ้น</h2>
            <div class="divider-custom"></div>
            <p class="lang-text" data-th="บริษัท เค.ซี.เมททอลชีท จำกัด (มหาชน)" data-en="K.C. METAL SHEET PUBLIC CO.,LTD">บริษัท เค.ซี.เมททอลชีท จำกัด (มหาชน)</p>
        </div>
    </div>

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-10">
                <div class="price-card">
                    <div class="row align-items-center">
                        <div class="col-md-6 border-end text-center">
                            <h6 class="text-muted mb-2 lang-text" data-th="ราคาล่าสุด (KCM)" data-en="Last Price (KCM)">ราคาล่าสุด (KCM)</h6>
                            <div id="last_price" class="stock-value">...</div>
                            <div id="price_change" class="mt-2 lang-text" data-th="กำลังโหลด..." data-en="Loading...">กำลังโหลด...</div>
                        </div>

                        <div class="col-md-6 ps-md-5">
                            <div class="row mb-2">
                                <div class="col-6 info-label lang-text" data-th="เปิด:" data-en="Open:">เปิด:</div>
                                <div id="open_price" class="col-6 info-value">...</div>
                            </div>
                            <div class="row mb-2">
                                <div class="col-6 info-label lang-text" data-th="สูงสุด:" data-en="High:">สูงสุด:</div>
                                <div id="high_price" class="col-6 info-value">...</div>
                            </div>
                            <div class="row mb-2">
                                <div class="col-6 info-label lang-text" data-th="ต่ำสุด:" data-en="Low:">ต่ำสุด:</div>
                                <div id="low_price" class="col-6 info-value">...</div>
                            </div>
                            <div class="row mb-2">
                                <div class="col-6 info-label lang-text" data-th="ปริมาณการซื้อขาย:" data-en="Volume:">ปริมาณการซื้อขาย:</div>
                                <div id="volume" class="col-6 info-value">...</div>
                            </div>
                        </div>
                    </div>

                    <div class="text-center">
                        <a href="https://www.set.or.th/th/market/product/stock/quote/KCM/price" target="_blank" class="set-link-btn">
                            <span class="lang-text" data-th="ดูข้อมูล Real-time จาก SET" data-en="View Real-time Data from SET">ดูข้อมูล Real-time จาก SET</span> 
                            <i class="fa fa-external-link-alt ms-2"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="container mt-5 mb-5">
        <div class="row justify-content-center">
            <div class="col-lg-10">
                <div class="price-card" style="margin-top: 0; padding: 20px;">
                    <h4 class="mb-4 lang-text" data-th="กราฟราคาหุ้น (KCM)" data-en="Stock Price Chart (KCM)" style="color: #2b3990; font-weight: 600;">กราฟราคาหุ้น (KCM)</h4>
                    
                    <div id="tradingview_container" style="height: 500px; width: 100%">
                        <div id="tradingview_kcm" style="height: 100%; width: 100%"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
<footer id="newsletter">
    <div class="container">
      <!-- <div class="row">
        <div class="col-lg-8 offset-lg-2">
          <div class="section-heading">
            <h4>Join our mailing list to receive the news &amp; latest trends</h4>
          </div>
        </div>
        <div class="col-lg-6 offset-lg-3">
          <form id="search" action="#" method="GET">
            <div class="row">
              <div class="col-lg-6 col-sm-6">
                <fieldset>
                  <input type="address" name="address" class="email" placeholder="Email Address..." autocomplete="on" required>
                </fieldset>
              </div>
              <div class="col-lg-6 col-sm-6">
                <fieldset>
                  <button type="submit" class="main-button">Subscribe Now <i class="fa fa-angle-right"></i></button>
                </fieldset>
              </div>
            </div>
          </form>
        </div>
      </div> -->
      <div class="row">
        <div class="col-lg-3">
          <div class="footer-widget">
            <h4 data-th="ติดต่อเรา" data-en="Contact Us">ติดต่อเรา</h4>
            <p style="color:rgb(251, 249, 249);" data-th="567 หมู่ 2 ถ.เลี่ยงเมือง ต.พระลับ อ.เมือง จ.ขอนแก่น 40000"
              data-en="567 Moo 2, Bypass Road, Phra Lap, Mueang, Khon Kaen 40000">
              567 หมู่ 2 ถ.เลี่ยงเมือง ต.พระลับ อ.เมือง จ.ขอนแก่น 40000
            </p>
            <p><a href="#">043-306999</a></p>
            <p><a href="#">kcm@kcmetalsheet.com </a></p>
          </div>
        </div>
        <div class="col-lg-3">
          <div class="footer-widget">
            <!-- <h4>About Us</h4>
            <ul>
              <li><a href="#">Home</a></li>
              <li><a href="#">Services</a></li>
              <li><a href="#">About</a></li>
              <li><a href="#">Testimonials</a></li>
              <li><a href="#">Pricing</a></li>
            </ul>
            <ul>
              <li><a href="#">About</a></li>
              <li><a href="#">Testimonials</a></li>
              <li><a href="#">Pricing</a></li>
            </ul> -->
          </div>
        </div>
        <div class="col-lg-3">
          <div class="footer-widget">
            <h4 data-th="ลิงก์ที่เป็นประโยชน์" data-en="Useful Links">ลิงก์ที่เป็นประโยชน์</h4>
            <ul>
              <li>
                <a href="ksee/privacy-policy.html">
                  <span data-th="นโยบายความเป็นส่วนตัว Ksee" data-en="Ksee Privacy Policy">นโยบายความเป็นส่วนตัว
                    Ksee</span>
                </a>
              </li>
            </ul>
            <li><a href="#"></a></li>
            <li><a href="#"></a></li>
            <li><a href="#"></a></li>
            <li><a href="#"> </a></li>
            </ul>

          </div>
        </div>
        <div class="col-lg-3">
          <div class="footer-widget">
            <h4 data-th="เกี่ยวกับบริษัทเรา" data-en="About Our Company">About Our Company</h4>
            <div class="logo">
              <img src="assets/images/white-logo2.png" alt="">
            </div>
            <p data-th="มุ่งมั่นเป็นผู้นำด้านการผลิต จำหน่ายและบริการ ผลิตภัณฑ์โครงสร้างอาคารเหล็กสำเร็จรูป (Steel Building Solution) 
            ตลอดจนอุปกรณ์ติดตั้ง เพื่อตอบสนองความต้องการของลูกค้า พร้อมสร้างความประทับใจ และมีส่วนร่วมกับความสำเร็จของลูกค้า 
            ด้วยการปรับปรุงและพัฒนากระบวนการปฏิบัติงานอย่างต่อเนื่อง"
              data-en="Committed to being a leader in the production, distribution, and service of Steel Building Solution products and installation accessories. We aim to meet all customer needs, creating impressive experiences and contributing to our customers' success through continuous improvement and development of our operational processes.">
              มุ่งมั่นเป็นผู้นำด้านการผลิต จำหน่ายและบริการ ผลิตภัณฑ์โครงสร้างอาคารเหล็กสำเร็จรูป (Steel Building
              Solution)
              ตลอดจนอุปกรณ์ติดตั้ง เพื่อตอบสนองความต้องการของลูกค้า พร้อมสร้างความประทับใจ
              และมีส่วนร่วมกับความสำเร็จของลูกค้า
              ด้วยการปรับปรุงและพัฒนากระบวนการปฏิบัติงานอย่างต่อเนื่อง
            </p>
          </div>
        </div>
        <div class="col-lg-12">
          <div class="copyright-text">
            <p>Copyright © 2024 | Powered by Rodtank.
              <!-- <br>Design: <a href="https://templatemo.com/" target="_blank" title="css templates">TemplateMo</a></p> -->
          </div>
        </div>
      </div>
    </div>
  </footer>
    <script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>
    
    <script>
        let currentLang = 'th'; // ตัวแปรเก็บภาษาปัจจุบัน

        // ฟังก์ชันเปลี่ยนภาษา
        function setLang(lang) {
            currentLang = lang;
            
            // 1. Loop หา element ที่มี class="lang-text" (Header ไม่มี class นี้แล้ว จึงไม่ถูกเปลี่ยน)
            const elements = document.querySelectorAll('.lang-text');
            elements.forEach(el => {
                const text = el.getAttribute(`data-${lang}`);
                if (text) {
                    if(el.querySelector('i')) {
                        const icon = el.querySelector('i').outerHTML;
                        el.innerHTML = text + ' ' + icon;
                    } else {
                        el.innerText = text;
                    }
                }
            });

            // 2. ปรับสถานะปุ่ม Active
            document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
            const activeBtn = document.getElementById(`btn-${lang}`);
            if(activeBtn) activeBtn.classList.add('active');

            // 3. โหลดข้อมูลหุ้นใหม่ (เพื่อเปลี่ยนหน่วย M / ล้าน)
            fetchStockData();

            // 4. โหลด TradingView ใหม่ตามภาษา
            loadTradingView(lang === 'th' ? 'th_TH' : 'en');
        }

        // ฟังก์ชันโหลดกราฟ
        function loadTradingView(locale) {
            document.getElementById('tradingview_container').innerHTML = '<div id="tradingview_kcm" style="height: 100%; width: 100%"></div>';
            
            new TradingView.widget({
                "autosize": true,
                "symbol": "SET:KCM",
                "interval": "D",
                "timezone": "Asia/Bangkok",
                "theme": "light",
                "style": "1",
                "locale": locale,
                "toolbar_bg": "#f1f3f6",
                "enable_publishing": false,
                "allow_symbol_change": true,
                "container_id": "tradingview_kcm",
                "show_popup_button": true,
                "popup_width": "1000",
                "popup_height": "650"
            });
        }

        // ฟังก์ชันดึงราคาหุ้น
        async function fetchStockData() {
            try {
                const response = await fetch('https://query1.finance.yahoo.com/v8/finance/chart/KCM.BK');
                const data = await response.json();
                const quote = data.chart.result[0].indicators.quote[0];
                const meta = data.chart.result[0].meta;

                const lastPrice = meta.regularMarketPrice.toFixed(2);
                const prevClose = meta.chartPreviousClose;
                const change = (lastPrice - prevClose).toFixed(2);
                const changePercent = ((change / prevClose) * 100).toFixed(2);

                document.getElementById('last_price').innerText = lastPrice;
                document.getElementById('open_price').innerText = quote.open[0].toFixed(2);
                document.getElementById('high_price').innerText = Math.max(...quote.high).toFixed(2);
                document.getElementById('low_price').innerText = Math.min(...quote.low).toFixed(2);
                
                // ปรับหน่วย Volume ตามภาษา (ล้าน / M)
                const volUnit = currentLang === 'th' ? 'ล้าน' : 'M';
                document.getElementById('volume').innerText = (meta.regularMarketVolume / 1000000).toFixed(2) + " " + volUnit;

                const changeEl = document.getElementById('price_change');
                if (change >= 0) {
                    changeEl.className = "status-up";
                    changeEl.innerHTML = `<i class="fas fa-caret-up"></i> +${change} (+${changePercent}%)`;
                } else {
                    changeEl.className = "status-down";
                    changeEl.innerHTML = `<i class="fas fa-caret-down"></i> ${change} (${changePercent}%)`;
                }

            } catch (error) {
                // ข้อมูลจำลองหากโหลดไม่ได้
                document.getElementById('last_price').innerText = "0.16";
                document.getElementById('price_change').className = "status-down";
                document.getElementById('price_change').innerHTML = `<i class="fas fa-caret-down"></i> -0.01 (-5.88%)`;
                document.getElementById('open_price').innerText = "0.17";
                document.getElementById('high_price').innerText = "0.17";
                document.getElementById('low_price').innerText = "0.15";
                
                const volUnitMock = currentLang === 'th' ? 'ล้าน' : 'M';
                document.getElementById('volume').innerText = "15.30 " + volUnitMock;
            }
        }

        window.onload = function() {
            setLang('th'); // ตั้งค่าเริ่มต้น
            setInterval(fetchStockData, 60000);
        };
    </script>

    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="assets/js/custom.js"></script>
<!-- 5555555 -->
</body>
</html>